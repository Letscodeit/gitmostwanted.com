{% extends "layout.html" %}

{% set page_title = 'Trending' %}

{% from "macros/attitude.html" import user_attitude %}
{% from "macros/repository.html" import repository, repository_filter %}

{% block body %}
  <dl class="sub-nav">
    {% for r in ['day', 'week', 'month'] %}
      <dd {{ 'class=active' if range == r }}>
        <a href="{{ url_for('index', rng=r) }}">{{ r|capitalize() }}</a>
      </dd>
    {% endfor %}

    {% if g.user %}
      <dd><a href="{{ url_for('user_attitude.list_unchecked') }}">Attitude</a></dd>
    {% endif %}
  </dl>

  {% if not g.user %}
    <div data-alert class="alert-box info">
      Did you know that it makes no sense to use GMW without authentication? Because it looks identical to
      <a href="https://github.com/trending" target="_blank">GitHub Trending repositories</a>.
    </div>
  {% endif %}

  <div class="row" id="gh-entries">
    {{ repository_filter(languages, request.args.get('lang')) }}

    <div class="small-12 columns">
      <ul class="small-block-grid-1 medium-block-grid-2 large-block-grid-3">
        {% for (entry, attitude) in entries %}
          {% call(repo) repository(entry.repo) %}
            <div class="right">
              <span class="label secondary">
                +{{ entry.cnt_watch }} <i class="fi-star"></i>
              </span>
            </div>

            {% if g.user %}
                {{ user_attitude(repo.id, attitude) }}
            {% endif %}
          {% endcall %}
        {% endfor %}
      </ul>
    </div>
  </div>
{% endblock %}
